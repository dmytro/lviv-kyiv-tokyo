<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.1 release (February 19th, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Буферний кеш</TITLE>
<META NAME="description" CONTENT="Буферний кеш">
<META NAME="keywords" CONTENT="linux,ukrainian,guide,sag">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL="STYLESHEET" HREF="sag.css">
<LINK REL="previous" HREF="node70.html">
<LINK REL="up" HREF="node65.html">
<LINK REL="next" HREF="node72.html">
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<!--Navigation Panel-->
<A NAME="tex2html1359"
 HREF="node72.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="next_motif.gif"></A> 
<A NAME="tex2html1355"
 HREF="node65.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="up_motif.gif"></A> 
<A NAME="tex2html1351"
 HREF="node70.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="previous_motif.gif"></A> 
<A NAME="tex2html1357"
 HREF="node7.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="contents_motif.gif"></A> 
<A NAME="tex2html1358"
 HREF="node120.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="index_motif.gif"></A> 
<BR>
<B> Дал╕:</B> <A NAME="tex2html1360"
 HREF="node72.html">Загрузка та вимкнення системи</A>
<B> Вгору:</B> <A NAME="tex2html1356"
 HREF="node65.html">Керування пам'яттю</A>
<B> Назад:</B> <A NAME="tex2html1352"
 HREF="node70.html">Вид╕лення своп простору</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00760000000000000000">
Буферний кеш</A>
</H1><FONT SIZE="+1"><FONT SIZE="+1"><A NAME="tex2html122"
 HREF="footnode.html#foot4856"><SUP>114</SUP></A>
<A NAME="sec:buffer-cache">&#160;</A></FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Швидк╕сть читання з диску<A NAME="tex2html123"
 HREF="footnode.html#foot4685"><SUP>115</SUP></A>, ╓ набагато меншою,
	н╕ж швидк╕сть доступу до (справжньо╖) пам'ят╕.  Часто
	трапля╓ться так, що Вам потр╕бно прочитати одн╕ й т╕ ж дан╕
	к╕лька раз╕в з диску на протяз╕ в╕дносно короткого в╕дтинку
	часу. Простий приклад: Ви чита╓те листа, який прийшов
	електронною поштою, пот╕м в╕дкрива╓те цього ж листа в
	редактор╕ для того, щоб дати на нього в╕дпов╕дь, пот╕м
	в╕дкрива╓те програму електонно╖ пошти, яка в╕д╕шле цю
	в╕дпов╕дь. Або ╕нший випадок: ск╕льки раз╕в викону╓ться
	команда <TT>ls</TT><A NAME="4862">&#160;</A> в систем╕ з багатьма користувачами? Швидк╕сть
	роботи системи можна п╕дняти, якщо читати вс╕ дан╕ з диску
	т╕льки один раз, ╕ тримати ╖х в пам'ят╕ п╕сля цього доти, доки
	вони б╕льше не потр╕бн╕. Таким чином п╕двищу╓ться швидк╕сть
	вс╕х операц╕й читання з диску кр╕м само╖ першо╖. Це називають
	<B>дисковим буфером</B>, ╕ пам'ять, яка використову╓ться при
	цьому називають <B>буферним кешем</B>.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Пам'ять дуже часто обмежена, ╕ нав╕ть б╕льше того, ╖╖ часто
	недостатньо. Тому дисковий буфер не вда╓ться зробити достатньо
	великим (тобто, в╕н не може збер╕гати вс╕ дан╕, як╕ Вам
	потр╕бн╕). Коли кеш заповню╓ться, дан╕, до яких не було
	доступу на протяз╕ найдовшого часу стираються, ╕ вив╕льнена
	пам'ять використову╓ться п╕д нов╕ дан╕.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Дисковий буфер працю╓ також для запису. З одного боку, дан╕
	записан╕ на диск, часто читаються п╕сля цього знову в пам'ять
	(наприклад, програма записана на диск редактором, чита╓ться
	п╕сля цього комп╕лятором). Отож, непогано мати т╕льки-що
	записан╕ дан╕ ╕ в кеш╕ також. З ╕ншого боку, пом╕стивши дан╕
	т╕льки в кеш, ╕ не записуючи насправд╕ ╖х на диск, операц╕я
	запису робиться значно швидшою. Справжн╕й запис на диск
	викону╓ться п╕сля цього, на фон╕ яко╖сь ╕ншо╖ роботи, не
	запов╕льнюючи ╖х роботи.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Б╕льш╕сть операц╕йних систем мають дисков╕ буфери та кеш (хоча
	в деяких випадках вони називаються ╕накше), але не вс╕ з цих
	систем працюють за одними й тими ж принципами. Деяк╕ з них ╓ з
	<B> наскр╕зним записом</B><A NAME="tex2html124"
 HREF="footnode.html#foot4866"><SUP>116</SUP></A> - дан╕
	записуються на диск без затримки (але, звичайно ж, тримаються
	в кеш╕). Кеш, у якому запис в╕дбува╓ться п╕зн╕ше, назива╓ться
	<B>кешем з в╕дкладеним записом</B>. В╕дкладений запис значно
	ефективн╕ший, н╕ж наскр╕зний запис, але в той же час, б╕льш
	схильний до помилок: якщо щось негаразд з системою - або зника╓
	напруга (хтось висмикнув шнур з розетки), або дискету вийняли
	з приводу до того, як дан╕ з буферу записан╕ на не╖ -  вс╕ дан╕,
	як╕ були в буфер╕ на цей момент, загублен╕. ╤нколи це нав╕ть
	може означати, що файлова система на диску (якщо така була
	там) не в повному порядку. Бо не записан╕ на диск дан╕ можуть
	бути деякими контрольними даними файлово╖ системи.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Через це не можна вимикати систему без виконання в╕дпов╕дно╖
	процедури вимикання (див. п╕дрозд╕л&nbsp;<A HREF="node72.html#ch:boothalt"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]"
 SRC="cross_ref_motif.gif"></A>), просто
	витягнувши шнура з розетки.  Дискету з дисководу можна
	витягувати т╕льки п╕сля розмонтовування ╖╖, або ж т╕льки п╕сля
	того, як команда, яка виконувала запис на дискету, пов╕домить
	Вам про те, що вона зак╕нчила писати. Команда <TT>sync</TT><A NAME="4873">&#160;</A>
	<B>злива╓</B><A NAME="tex2html125"
 HREF="footnode.html#foot4875"><SUP>117</SUP></A> буфер, тобто примусово запису╓
	вс╕ незаписан╕ дан╕ на диск, ╕ нею треба користуватися тод╕,
	коли треба впевнитися, що все записано безпечно на диск. В
	системах з традиц╕йними Юн╕ксами ╕сну╓ програма <TT>update</TT><A NAME="4881">&#160;</A>,
	яка викону╓ться в фоновому режим╕ ╕ робить <TT>sync</TT><A NAME="4883">&#160;</A> кожн╕
	30&nbsp;секунд, тобто в б╕льшост╕ випадк╕в нема╓ необх╕дност╕
	робити <TT>sync</TT><A NAME="4885">&#160;</A>. В Л╕накс╕ ╓ ╕нший демон <TT>bdflush</TT><A NAME="4887">&#160;</A>, який
	робить чист╕шу роботу - в╕н викону╓ <TT>sync</TT><A NAME="4889">&#160;</A> част╕ше для
	того, щоб запоб╕гти раптовим короткочасним зависанням системи,
	як╕ ╕нколи трапляються при високих нагрузках на диск
	викликаних командою <TT>sync</TT><A NAME="4891">&#160;</A>.
	
	В Л╕накс╕ <TT>bdflush</TT><A NAME="4893">&#160;</A> запуска╓ться процесом <TT>update</TT><A NAME="4895">&#160;</A>. В
	б╕льшост╕ випадк╕в нема╓ причини п╕клуватися про них, але,
	якщо з деяких причин трапля╓ться так, що демон <TT>bdflush</TT><A NAME="4897">&#160;</A>
	вмира╓, то ядро видасть попередження про це ╕ його потр╕бно
	запустити вручну (<TT>/sbin/update</TT><A NAME="4899">&#160;</A>).
	
	Дисковий кеш звичайно трима╓ в буфер╕ не файли, а блоки -
	найменш╕ одиниц╕ дискового вводу/виводу (в Л╕накс╕ вони р╕вн╕
	1&nbsp;кбайту). Таким чином тримаються в буфер╕ також директор╕╖,
	суперблоки, ╕нформац╕я файлово╖ системи та дан╕ диск╕в без
	файлових систем. 
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Ефективн╕сть кешу в першу чергу залежить в╕д його
	розм╕ру. Занадто  малий кеш практично не робить н╕чого - вс╕ т╕
	дан╕, як╕ в╕н трима╓ в буфер╕ будуть злит╕ на диск ран╕ше, н╕ж
	кеш встигне ╖х використати. Критичний розм╕р кешу залежить в╕д
	того, ск╕льки даних чита╓ться ╕ запису╓ться, ╕ як часто
	потр╕бен доступ до одних ╕ тих же даних. ╢диний шлях це
	д╕знатися - це шлях експерименту.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">Якщо дисковий кеш ма╓ ф╕ксований розм╕р, то його надм╕рний
	розм╕р теж знижу╓ ефективн╕сть роботи. Кеш забира╓ оперативну
	пам'ять в╕д системи, пам'ять ста╓ меншою, що в свою чергу
	приводить до п╕двищення частоти своп╕н╜у, а своп╕н╜ - такий же
	пов╕льний, як ╕ ╕нш╕ дисков╕ перац╕╖. Для п╕двищення
	ефективност╕ використання пам'ят╕ Л╕накс автоматично
	використову╓ всю в╕льну пам'ять п╕д дисковий кеш, ╕
	автоматично зменшу╓ розм╕р кешу, коли програмам потр╕бно
	б╕льше пам'ят╕.
</FONT></FONT>
<P>
<FONT SIZE="+1"><FONT SIZE="+1">В Л╕накс╕ в╕д адм╕н╕стратора не вимага╓ться н╕яких додаткових
	д╕й для користування кешем - все в╕дбува╓ться
	автоматично. Кр╕м вимикання комп'ютера за правилами та
	виймання дискети з дисководу тод╕, коли потр╕бно, Вам нема╓
	про що турбуватися.
</FONT></FONT>
<P>
<BR><HR>
<ADDRESS>
<I>Dmytro Kovalev</I>
<BR><I>1999-06-10</I>
</ADDRESS>
</BODY>
</HTML>
